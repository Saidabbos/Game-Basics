<!doctype html>
<html>
<head>
    <script src="js/phaser.js"></script>
    <style>
        body{margin:0}
    </style>
<!--    <script src="ho.js"></script>-->
    <script type="text/javascript">
        var height = 700;
        var width = 500;
        var tree;
        var apple_num = 0;
        var max_apples = 10;
        var apple_audio;
    
        var game = new Phaser.Game(width, height, Phaser.AUTO, '', { preload: preload, create: create, update: update });

        function preload() {
            game.load.image("tree", "res/tree.png");
            game.load.image("apple", "res/apple.png");

            game.load.audio('1_red_apples', ['res/audio/apples/01_red_apple.mp3','res/audio/apples/01_red_apple.ogg']);
            game.load.audio('2_red_apples', ['res/audio/apples/02_red_apples.mp3','res/audio/apples/02_red_apples.ogg']);
            game.load.audio('3_red_apples', ['res/audio/apples/03_red_apples.mp3','res/audio/apples/03_red_apples.ogg']);
            game.load.audio('4_red_apples', ['res/audio/apples/04_red_apples.mp3','res/audio/apples/04_red_apples.ogg']);
            game.load.audio('5_red_apples', ['res/audio/apples/05_red_apples.mp3','res/audio/apples/05_red_apples.ogg']);
            game.load.audio('6_red_apples', ['res/audio/apples/06_red_apples.mp3','res/audio/apples/06_red_apples.ogg']);
            game.load.audio('7_red_apples', ['res/audio/apples/07_red_apples.mp3','res/audio/apples/07_red_apples.ogg']);
            game.load.audio('8_red_apples', ['res/audio/apples/08_red_apples.mp3','res/audio/apples/08_red_apples.ogg']);
            game.load.audio('9_red_apples', ['res/audio/apples/09_red_apples.mp3','res/audio/apples/09_red_apples.ogg']);
            game.load.audio('10_red_apples', ['res/audio/apples/10_red_apples.mp3','res/audio/apples/10_red_apples.ogg']);
        }

        function create() {
            game.stage.backgroundColor = '#008aff';             

            tree = game.add.sprite(0, 0, 'tree');
            tree.position.y = height - tree.height;

            apples = game.add.group();
            //game.physics.startSystem(Phaser.Physics.ARCADE);
            game.input.onDown.add(click, this);
        }

        function update(){

        }

        function click(){
            //console.log(game.input.x + ":" + game.input.y);
            var x = game.input.x;
            var y = game.input.y;

            if(x > 50 && x < 450 && y > 190 && y < 450){
                apple_num += 1;
                //var apple = game.add.sprite(x-28, y-28, 'apple');
                var apple = apples.create(x-28, y-28, 'apple');
                apple.name = 'apple' + apple_num;
                apple.scale.setTo(.4,.4);

                apple_audio = game.add.audio(apple_num + '_red_apples');
                apple_audio.play();

                if(apple_num == 10){
                    apple_num = 0;
                    console.log("10 apples");
                    for(var i = 0;i < 10;i++){
                        var app = apples.children[i];
                        game.physics.arcade.enable(app);
                        app.body.gravity.set(0, 180);
                        app.body.bounce.set(0.8);
                        app.enableBody = true;
                        app.body.collideWorldBounds = true;
                    }
                }
            }
            //Set the game to strech and fill the screen
            //game.scale.fullScreenScaleMode = Phaser.ScaleManager.EXACT_FIT;
            game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;
            game.scale.startFullScreen();
        }

    </script>
</head>
<body>

</body>
</html>
